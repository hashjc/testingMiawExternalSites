<!DOCTYPE html>
<html dir="ltr" lang="en-US">

<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Messaging for In app and web on external sites</title>
   
</head>

<body>
	<p>Helllo World. <br> Testing Messaging for In app and Web on this domain.<br>
	Created Messaging Channel.<br>
	Created Embedded Service Deployment.<br>
	Created Omni-Channel Flow for routing. <br>
	</p>
  <script type='text/javascript'>
	function initEmbeddedMessaging() {
		try {
			embeddedservice_bootstrap.settings.language = 'en_US'; // For example, enter 'en' or 'en-US'

      //Read Browser details
      window.addEventListener("onEmbeddedMessagingReady", () => {
            
	console.log( "Inside Prechat API!!" );
	const fetchBrowserName = () => {

		let browserInfo = navigator.userAgent;
		let browserName;
		if ( 
			browserInfo.includes('Opera') || 
			browserInfo.includes('Opr') 
		) {
		
			browserName = 'Opera';
			
		} else if ( browserInfo.includes( 'Edg' ) ) {
		
			browserName = 'Edge';
			
		} else if (browserInfo.includes( 'Chrome' ) ) {
		
			browserName = 'Chrome';
			
		} else if ( browserInfo.includes( 'Safari' ) ) {
		
			browserName = 'Safari';
			
		} else if ( browserInfo.includes( 'Firefox' ) ) {
		
			browserName= 'Firefox';
			
		} else {
		
			browserName = 'unknown';
			
		}
		return browserName;
		
	}

	const strBrowserName = fetchBrowserName();
	console.log(
		'Browser Name is',
		strBrowserName
	);
	const browserLanguage = navigator.language;
	console.log(
		'Browser Language is',
		browserLanguage
	);
	const browserPlatform = navigator.platform;
	console.log(
		'Browser Platform is',
		browserPlatform
	);
        //Ensure you have created custom paramters for messaging channel associated with your embedded service deployment.
        //Make sure your parameters are hidden. And you have created input variables in your associated omni-channel flow.
	    //Also create fields on Messaging session object and store these values of custom parameters in the messaging session record.
  embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields( { 
		"BrowserName" : strBrowserName,  	
		"BrowserLanguage" : browserLanguage,  	
		"BrowserPlatform" : browserPlatform 	
	} );
	
});
      
      //Initialize chat button
			embeddedservice_bootstrap.init(
				'00D7Q000008O3Z2',
				'ESD_MiawL2_WithExternalSites',
				'https://junesoftware-3f-dev-ed.my.site.com/ESWESDMiawL2WithExterna1721220769115',
				{
					scrt2URL: 'https://junesoftware-3f-dev-ed.my.salesforce-scrt.com'
				}
			);
		} catch (err) {
			console.error('Error loading Embedded Messaging: ', err);
		}
	};
</script>
<script type='text/javascript' src='https://junesoftware-3f-dev-ed.my.site.com/ESWESDMiawL2WithExterna1721220769115/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>

  
</body>

</html>
